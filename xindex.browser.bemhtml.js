var BEMHTML;!function(t){function e(e){var n,i=function(e,n){return function(i){if("object"==typeof n&&void 0!==e)e.exports=i();else if("function"==typeof define&&define.amd)define([],i);else{var r;r="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:this,r.bemhtml=i()}}(function(){return function t(e,n,i){function r(o,h){if(!n[o]){if(!e[o]){var c="function"==typeof require&&require;if(!h&&c)return c(o,!0);if(s)return s(o,!0);var a=new Error("Cannot find module '"+o+"'");throw a.code="MODULE_NOT_FOUND",a}var u=n[o]={exports:{}};e[o][0].call(u.exports,function(t){var n=e[o][1][t];return r(n||t)},u,u.exports,t,e,n,i)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(t,e,n){function i(t){this.bemxjst=t,this.jsClass=null,this.tag=new s(this,"tag"),this.attrs=new s(this,"attrs"),this.bem=new s(this,"bem"),this.cls=new s(this,"cls"),o.apply(this,arguments)}var r=t("inherits"),s=t("../bemxjst/match").Match,o=t("../bemxjst/entity").Entity;r(i,o),n.Entity=i,i.prototype.init=function(t,e){this.block=t,this.elem=e,this.jsClass=this.bemxjst.classBuilder.build(this.block,this.elem)},i.prototype._keys={tag:1,content:1,attrs:1,mix:1,js:1,mods:1,elemMods:1,cls:1,bem:1},i.prototype.defaultBody=function(t){return t.mods=this.mods.exec(t),t.ctx.elem&&(t.elemMods=this.elemMods.exec(t)),this.bemxjst.render(t,this,this.tag.exec(t),this.js.exec(t),this.bem.exec(t),this.cls.exec(t),this.mix.exec(t),this.attrs.exec(t),this.content.exec(t),t.mods,t.elemMods)}},{"../bemxjst/entity":5,"../bemxjst/match":8,inherits:11}],2:[function(t,e,n){function i(t){h.apply(this,arguments),this._shortTagCloser=void 0!==t.xhtml&&t.xhtml?"/>":">",this._elemJsInstances=t.elemJsInstances,this._omitOptionalEndTags=t.omitOptionalEndTags,this._unquotedAttrs=void 0!==t.unquotedAttrs&&t.unquotedAttrs}var r=t("inherits"),s=t("../bemxjst/utils"),o=t("./entity").Entity,h=t("../bemxjst");r(i,h),e.exports=i,i.prototype.Entity=o,i.prototype.runMany=function(t){var e="",n=this.context,i=n.position,r=n._notNewList;if(r?n._listLength+=t.length-1:(n.position=0,n._listLength=t.length),n._notNewList=!0,this.canFlush)for(var s=0;s<t.length;s++)e+=n._flush(this._run(t[s]));else for(var s=0;s<t.length;s++)e+=this._run(t[s]);return r||(n.position=i),e},i.prototype.render=function(t,e,n,i,r,o,h,c,a,u,l){var p=t.ctx;if(void 0===n)n="div";else if(!n)return a||0===a?this._run(a):"";var f="<"+n;!0===i&&(i={});var d;i&&(d={},d[e.jsClass]=i);var m=void 0!==r?r:e.block||e.elem;m=!!m;var y=m&&d&&(this._elemJsInstances?e.block:e.block&&!e.elem);if(!m&&!o)return this.renderClose(f,t,n,c,m,p,a);f+=" class=";var x="";if(m){if(x+=e.jsClass,x+=this.buildModsClasses(e.block,e.elem,e.elem?l:u),h){var v=this.renderMix(e,h,d,y);x+=v.out,d=v.jsParams,y=v.addJSInitClass}o&&(x+=" "+("string"==typeof o?s.attrEscape(o).trim():o))}else x+="string"==typeof o?s.attrEscape(o).trim():o;return y&&(x+=" i-bem"),f+=this._unquotedAttrs&&s.isUnquotedAttr(x)?x:'"'+x+'"',m&&d&&(f+=" data-bem='"+s.jsAttrEscape(JSON.stringify(d))+"'"),this.renderClose(f,t,n,c,m,p,a)};var c={html:1,head:1,body:1,p:1,li:1,dt:1,dd:1,colgroup:1,thead:1,tbody:1,tfoot:1,tr:1,th:1,td:1,option:1,rb:1,rt:1,rtc:1,rp:1,optgroup:1};i.prototype.renderClose=function(t,e,n,i,r,o,h){var a=t;return a+=this.renderAttrs(i),s.isShortTag(n)?(a+=this._shortTagCloser,this.canFlush&&(a=e._flush(a))):(a+=">",this.canFlush&&(a=e._flush(a)),(h||0===h)&&(a+=this.renderContent(h,r)),this._omitOptionalEndTags&&c.hasOwnProperty(n)||(a+="</"+n+">")),this.canFlush&&(a=e._flush(a)),a},i.prototype.renderAttrs=function(t){var e="";if(s.isObj(t))for(var n in t){var i=t[n];if(void 0!==i&&!1!==i&&null!==i)if(!0===i)e+=" "+n;else{var r=s.isSimple(i)?i:this.run(i);e+=" "+n+"=",e+=this._unquotedAttrs&&s.isUnquotedAttr(r)?r:'"'+s.attrEscape(r)+'"'}}return e},i.prototype.renderMix=function(t,e,n,i){var r={},o=this.context,h=n,c=i;r[t.jsClass]=!0,Array.isArray(e)||(e=[e]);for(var a=this.classBuilder,u="",l=0;l<e.length;l++){var p=e[l];if(p){"string"==typeof p&&(p={block:p,elem:void 0});var f=!1;p.elem?f=p.elem!==t.elem&&p.elem!==o.elem||p.block&&p.block!==t.block:p.block&&(f=!(p.block===t.block&&p.mods)||p.mods&&t.elem);var d=p.block||p._block||o.block,m=p.elem||p._elem||o.elem,y=a.build(d,m),x=p.elem||p._elem||(p.block?void 0:o.elem);if(f&&(u+=" "+a.build(d,x)),u+=this.buildModsClasses(d,x,p.elem||!p.block&&(p._elem||o.elem)?p.elemMods:p.mods),p.js&&(h||(h={}),h[a.build(d,p.elem)]=!0===p.js?{}:p.js,c||(c=this._elemJsInstances?p.elem||d:d&&!p.elem)),p.mix){var v=this.renderMix(t,p.mix,h,c);h=s.extend(h,v.jsParams),c=v.addJSInitClass,u+=v.out}if(f&&!r[y]){r[y]=!0;var b=this.entities[y];if(b){var w=o.block,g=o.elem,k=b.mix.exec(o);if(o.elem=g,o.block=w,k)for(var E=0;E<k.length;E++){var M=k[E];if(M&&(!M.block&&!M.elem||!r[a.build(M.block,M.elem)])){if(M.block)continue;M._block=d,M._elem=m,e=e.slice(0,l+1).concat(M,e.slice(l+1))}}}}}}return{out:u,jsParams:h,addJSInitClass:c}},i.prototype.buildModsClasses=function(t,e,n){if(!n)return"";var i,r="";for(i in n)if(n.hasOwnProperty(i)&&""!==i){var s=n[i];if(s||0===s){"boolean"!=typeof s&&(s+="");var o=this.classBuilder;r+=" "+(e?o.buildElemClass(t,e,i,s):o.buildBlockClass(t,i,s))}}return r}},{"../bemxjst":7,"../bemxjst/utils":10,"./entity":1,inherits:11}],3:[function(t,e,n){function i(t){this.elemDelim=t.elem||"__",this.modDelim="string"==typeof t.mod?{name:t.mod||"_",val:t.mod||"_"}:{name:t.mod&&t.mod.name||"_",val:t.mod&&t.mod.val||"_"}}n.ClassBuilder=i,i.prototype.build=function(t,e){return e?t+this.elemDelim+e:t},i.prototype.buildModPostfix=function(t,e){var n=this.modDelim.name+t;return!0!==e&&(n+=this.modDelim.val+e),n},i.prototype.buildBlockClass=function(t,e,n){var i=t;return n&&(i+=this.buildModPostfix(e,n)),i},i.prototype.buildElemClass=function(t,e,n,i){return this.buildBlockClass(t)+this.elemDelim+e+this.buildModPostfix(n,i)},i.prototype.split=function(t){return t.split(this.elemDelim,2)}},{}],4:[function(t,e,n){function i(t){this._bemxjst=t,this.ctx=null,this.block="",this._currBlock="",this.elem=null,this.mods={},this.elemMods={},this.position=0,this._listLength=0,this._notNewList=!1,this.escapeContent=!1!==t.options.escapeContent}var r=t("./utils");n.Context=i,i.prototype._flush=null,i.prototype.isSimple=r.isSimple,i.prototype.isShortTag=r.isShortTag,i.prototype.extend=r.extend,i.prototype.identify=r.identify,i.prototype.xmlEscape=r.xmlEscape,i.prototype.attrEscape=r.attrEscape,i.prototype.jsAttrEscape=r.jsAttrEscape,i.prototype.onError=function(t,e){console.error("bem-xjst rendering error:",{block:t.ctx.block,elem:t.ctx.elem,mods:t.ctx.mods,elemMods:t.ctx.elemMods},e)},i.prototype.isFirst=function(){return 1===this.position},i.prototype.isLast=function(){return this.position===this._listLength},i.prototype.generateId=function(){return r.identify(this.ctx)},i.prototype.reapply=function(t){return this._bemxjst.run(t)}},{"./utils":10}],5:[function(t,e,n){function i(t,e,n,i){this.bemxjst=t,this.block=null,this.elem=null,this.options={},this.canFlush=!0,this.def=new o(this),this.mix=new o(this,"mix"),this.js=new o(this,"js"),this.mods=new o(this,"mods"),this.elemMods=new o(this,"elemMods"),this.content=new o(this,"content"),this.rest={},this.init(e,n),this.initModes(i)}function r(){return this.ctx.content}var s=t("./utils"),o=t("./match").Match,h=t("./tree"),c=h.Template,a=h.PropertyMatch,u=h.CompilerOptions;n.Entity=i,i.prototype.init=function(t,e){this.block=t,this.elem=e},i.prototype._keys={content:1,mix:1,js:1,mods:1,elemMods:1},i.prototype._initRest=function(t){"default"===t?this.rest[t]=this.def:this._keys[t]?this.rest[t]=this[t]:this.rest[t]=this.rest[t]||new o(this,t)},i.prototype.initModes=function(t){for(var e=0;e<t.length;e++){for(var n=t[e],i=n.predicates.length-1;i>=0;i--){var r=n.predicates[i];if(r instanceof a&&"_mode"===r.key){n.predicates.splice(i,1),this._initRest(r.value),this.rest[r.value].push(n);break}}-1===i&&this.def.push(n);for(var i=n.predicates.length-1;i>=0;i--){var r=n.predicates[i];r instanceof u&&(this.options=s.extend(this.options,r.options))}}},i.prototype.prepend=function(t){for(var e=Object.keys(this.rest),n=0;n<e.length;n++){var i=e[n];t.rest[i]&&this.rest[i].prepend(t.rest[i])}e=Object.keys(t.rest);for(var n=0;n<e.length;n++){var i=e[n];this.rest[i]||(this._initRest(i),this.rest[i].prepend(t.rest[i]))}},i.prototype.run=function(t){return 0!==this.def.count?this.def.exec(t):this.defaultBody(t)},i.prototype.setDefaults=function(){if(0!==this.content.count&&this.content.push(new c([],r)),0!==this.def.count){this.canFlush=this.options.flush||!1;var t=this;this.def.push(new c([],function(){return t.defaultBody(this)}))}}},{"./match":8,"./tree":9,"./utils":10}],6:[function(t,e,n){function i(t,e){this.name="BEMXJSTError",this.message=t,Error.captureStackTrace?Error.captureStackTrace(this,e||this.constructor):this.stack=(new Error).stack}i.prototype=Object.create(Error.prototype),i.prototype.constructor=i,n.BEMXJSTError=i},{}],7:[function(t,e,n){function i(t){this.options=t,this.entities=null,this.defaultEnt=null,this.tree=null,this.match=null,this.contextConstructor=function(t){c.call(this,t)},r(this.contextConstructor,c),this.context=null,this.classBuilder=new a(this.options.naming||{}),this.depth=0,this.canFlush=!1,this.oninit=null,this.defaultEnt=new this.Entity(this,"","",[]),this.defaultElemEnt=new this.Entity(this,"","",[])}var r=t("inherits"),s=t("./tree").Tree,o=t("./tree").PropertyMatch,h=t("./tree").AddMatch,c=t("./context").Context,a=t("./class-builder").ClassBuilder,u=t("./utils");e.exports=i,i.prototype.locals=s.methods.concat("local","applyCtx","applyNext","apply"),i.prototype.runOninit=function(t,e){var n=e||this;n.BEMContext=this.contextConstructor;for(var i=0;i<t.length;i++){(0,t[i])(n,{BEMContext:n.BEMContext})}},i.prototype.compile=function(t){function e(){return c.run(c.context.ctx)}function n(){return c._run(c.context.ctx)}function i(t,i){return i?c.local(i,function(){return c.local({ctx:t},n)}):c.local({ctx:t},e)}function r(t,i){return i?c.local(i,function(){return c.local({ctx:t},e)}):c.local({ctx:t},n)}function o(t,e){return c.applyMode(t,e)}function h(t){return function(e){return c.local(t,e)}}var c=this,a=new s({refs:{applyCtx:i,_applyCtx:r,apply:o}}),u=this.recompileInput(t),l=a.build(u,[h,i,function t(e){return e?c.local(e,t):c.applyNext()},o]);this.tree&&(this.runOninit(l.oninit),l={templates:l.templates.concat(this.tree.templates),oninit:this.tree.oninit.concat(l.oninit)}),this.tree=l;var p=this.groupEntities(l.templates);p=this.transformEntities(p),this.entities=p,this.oninit=l.oninit},i.prototype.getTemplate=function(t,e){return this.compile(t,e),this.exportApply()},i.prototype.recompileInput=function(t){var e=i.prototype.locals;return"function"==typeof t&&t.length===e.length?t:new Function(e.join(", "),u.fnToString(t))},i.prototype.groupEntities=function(e){for(var n={},i=0;i<e.length;i++){var r,s=e[i].clone(),c=null;r=void 0;for(var a=0;a<s.predicates.length;a++){var u=s.predicates[a];if(u instanceof o||u instanceof h){if("block"===u.key)c=u.value;else{if("elem"!==u.key)continue;r=u.value}s.predicates.splice(a,1),a--}}if(null===c){for(var l="block(…) subpredicate is not found.\n    See template with subpredicates:\n     * ",a=0;a<s.predicates.length;a++){var u=s.predicates[a];0!==a&&(l+="\n     * "),"_mode"===u.key?l+=u.value+"()":Array.isArray(u.key)?l+=u.key[0].replace("mods","mod").replace("elemMods","elemMod")+"('"+u.key[1]+"', '"+u.value+"')":l+="match(…)"}throw l+="\n    And template body: \n    ("+("function"==typeof s.body?s.body:JSON.stringify(s.body))+")","undefined"==typeof BEMXJSTError&&(BEMXJSTError=t("./error").BEMXJSTError),new BEMXJSTError(l)}var p=this.classBuilder.build(c,r);n[p]||(n[p]=[]),n[p].push(s)}return n},i.prototype.transformEntities=function(t){for(var e=[],n=Object.keys(t),i=0;i<n.length;i++){var r=n[i],s=this.classBuilder.split(r),o=s[0],h=s[1];"*"===h&&e.push(o),t[r]=new this.Entity(this,o,h,t[r])}if(t.hasOwnProperty("*")){for(var c=t["*"],i=0;i<n.length;i++){var r=n[i];"*"!==r&&t[r].prepend(c)}this.defaultEnt.prepend(c),this.defaultElemEnt.prepend(c)}for(var i=0;i<e.length;i++){for(var o=e[i],a=this.classBuilder.build(o,"*"),c=t[a],i=0;i<n.length;i++){var r=n[i];if(r!==a){var u=t[r];u.block===o&&void 0!==u.elem&&t[r].prepend(c)}}this.defaultElemEnt.prepend(c)}for(var i=0;i<n.length;i++){var r=n[i];t[r].setDefaults(),this.defaultEnt.setDefaults(),this.defaultElemEnt.setDefaults()}return t},i.prototype._run=function(t){return void 0===t||""===t||null===t?this.runEmpty():Array.isArray(t)?this.runMany(t):"string"!=typeof t.html||t.tag||void 0!==t.block||void 0!==t.elem||void 0!==t.cls||void 0!==t.attrs?u.isSimple(t)?this.runSimple(t):this.runOne(t):this.runUnescaped(t)},i.prototype.run=function(t){var e=this.match,n=this.context,i=this.depth;this.match=null,this.context=new this.contextConstructor(this),this.canFlush=null!==this.context._flush,this.depth=0;var r=this._run(t);return this.canFlush&&(r=this.context._flush(r)),this.match=e,this.context=n,this.depth=i,r},i.prototype.runEmpty=function(){return this.context._listLength--,""},i.prototype.runUnescaped=function(t){return this.context._listLength--,""+t.html},i.prototype.runSimple=function(t){return this.context._listLength--,!t&&0!==t||!0===t?"":"string"==typeof t&&this.context.escapeContent?u.xmlEscape(t):t},i.prototype.runOne=function(t){var e=this.context,n=e.ctx,i=e.block,r=e._currBlock,s=e.elem,o=e.mods,h=e.elemMods;t.block||t.elem?e._currBlock="":e._currBlock=e.block,e.ctx=t,t.block?(e.block=t.block,t.mods?e.mods=t.mods:t.block===i&&t.elem||(e.mods={})):t.elem?r&&(e.block=r):e.block="",e.elem=t.elem,t.elemMods?e.elemMods=t.elemMods:e.elemMods={};var c=e.block||"",a=e.elem;c||a?e.position++:e._listLength--,this.depth++;var u=!1,l=this.entities[this.classBuilder.build(c,a)];l?this.canFlush&&!l.canFlush&&(u=!0,this.canFlush=!1):(l=this.defaultEnt,void 0!==a&&(l=this.defaultElemEnt),l.init(c,a));var p=!0===this.options.production?this.tryRun(e,l):l.run(e);return e.ctx=n,e.block=i,e.elem=s,e.mods=o,e.elemMods=h,e._currBlock=r,this.depth--,u&&(this.canFlush=!0),p},i.prototype.tryRun=function(t,e){try{return e.run(t)}catch(e){return t.onError(t,e)||""}},i.prototype.renderContent=function(t,e){var n=this.context,i=n.position,r=n._listLength,s=n._notNewList;n._notNewList=!1,e&&(n.position=0,n._listLength=1);var o=this._run(t);return n.position=i,n._listLength=r,n._notNewList=s,o},i.prototype.local=function(t,e){for(var n=Object.keys(t),i=[],r=0;r<n.length;r++){for(var s=n[r],o=s.split("."),h=this.context,c=0;c<o.length-1;c++)h=h[o[c]];i.push({parts:o,value:h[o[c]]}),h[o[c]]=t[s]}for(var a=e.call(this.context),r=0;r<i.length;r++){for(var o=i[r].parts,h=this.context,c=0;c<o.length-1;c++)h=h[o[c]];h[o[c]]=i[r].value}return a},i.prototype.applyNext=function(){return this.match.exec(this.context)},i.prototype.applyMode=function(t,e){var n,i=this.match;if(i)i=this.match.entity.rest[t];else{var n=this.classBuilder.build(this.context.block,this.context.elem);i=this.entities[n].rest[t]}if(!i)return"mods"===t?this.context.mods:"elemMods"===t?this.context.elemMods:this.context.ctx[t];if(!e)return i.exec(this.context);var r=this,s=function(){return i.exec(r.context)};return this.local(e,s)},i.prototype.exportApply=function(t){var e=this,n=t||{};return n.apply=function(t){return e.run(t)},n.compile=function(t){return e.compile(t),n},this.runOninit(e.oninit,n),n}},{"./class-builder":3,"./context":4,"./error":6,"./tree":9,"./utils":10,inherits:11}],8:[function(t,e,n){function i(t,e){this.template=t,this.keys=e.key,this.value=e.value}function r(t,e){this.template=t,this.body=e.body}function s(t){this.template=t,this.wrap=null}function o(t){this.template=t,this.wrap=null}function h(t,e){this.template=t,this.key=e.key,this.value=e.value}function c(t,e){this.mode=t,this.predicates=new Array(e.predicates.length),this.body=e.body;for(var n=[],c=0,a=0;c<this.predicates.length;c++,a++){var u=e.predicates[c];u instanceof l?this.predicates[a]=new i(this,u):u instanceof d?(a--,n.push(new o(this))):u instanceof p?this.predicates[a]=new h(this,u):u instanceof m?this.predicates[a]=new r(this,u):u instanceof f?(a--,n.push(new s(this))):a--}for(var c=0;c<n.length;c++,a++)this.predicates[a]=n[c];this.predicates.length!==a&&(this.predicates.length=a)}function a(t,e){this.entity=t,this.modeName=e,this.bemxjst=this.entity.bemxjst,this.templates=[],this.mask=[0],this.maskSize=0,this.maskOffset=0,this.count=0,this.depth=-1,this.thrownError=null}var u=t("./tree"),l=u.PropertyMatch,p=u.AddMatch,f=u.WrapMatch,d=u.ExtendMatch,m=u.CustomMatch;i.prototype.exec=function(t){for(var e=t,n=0;n<this.keys.length-1;n++)if(!(e=e[this.keys[n]]))return!1;return e=e[this.keys[n]],!0===this.value?void 0!==e&&""!==e&&!1!==e&&null!==e:String(e)===this.value},r.prototype.exec=function(t){return this.body.call(t,t,t.ctx)},s.prototype.exec=function(t){var e=this.wrap!==t.ctx;return this.wrap=t.ctx,e},o.prototype.exec=function(t){var e=this.ext!==t.ctx;return this.ext=t.ctx,e},h.prototype.exec=function(t){return t[this.key]===this.value},n.MatchTemplate=c,n.Match=a,a.prototype.prepend=function(t){for(this.templates=t.templates.concat(this.templates),this.count+=t.count;Math.ceil(this.count/31)>this.mask.length;)this.mask.push(0);this.maskSize=this.mask.length},a.prototype.push=function(t){this.templates.push(new c(this,t)),this.count++,Math.ceil(this.count/31)>this.mask.length&&this.mask.push(0),this.maskSize=this.mask.length},a.prototype.tryCatch=function(t,e){try{return t.call(e,e,e.ctx)}catch(t){if(this.thrownError=t,this.modeName){this.thrownError.ctx=e,this.thrownError.name="BEMXJST ERROR";var n=this.entity.bemxjst.classBuilder,i=t.stack.split("\n")[1];this.thrownError.message="Template error in mode "+this.modeName+" in block "+n.build(e.ctx.block,e.ctx.elem)+"\n    "+t.message+"\n",this.thrownError.stack=this.thrownError.name+": "+this.thrownError.message+" "+i+"\n"+t.stack}}},a.prototype.exec=function(t){for(var e,n=this.checkDepth(),i=this.maskOffset,r=this.mask[i],s=1,o=0;o<this.count;o++){if(0==(r&s)){e=this.templates[o];for(var h=0;h<e.predicates.length;h++){if(!e.predicates[h].exec(t))break}if(h===e.predicates.length)break}1073741824===s?(i++,r=this.mask[i],s=1):s<<=1}if(o===this.count)return this.restoreDepth(n),"mods"===this.modeName?t.mods:"elemMods"===this.modeName?t.elemMods:t.ctx[this.modeName];var c=r,a=this.bemxjst.match;this.mask[i]|=s,this.bemxjst.match=this,this.thrownError=null;var u;u="function"==typeof e.body?this.tryCatch(e.body,t):e.body,this.mask[i]=c,this.bemxjst.match=a,this.restoreDepth(n);var l=this.thrownError;if(null!==l)throw this.thrownError=null,l;return u},a.prototype.checkDepth=function(){if(-1===this.depth)return this.depth=this.bemxjst.depth,-1;if(this.bemxjst.depth===this.depth)return this.depth;var t=this.depth;for(this.depth=this.bemxjst.depth,this.maskOffset+=this.maskSize;this.mask.length<this.maskOffset+this.maskSize;)this.mask.push(0);return t},a.prototype.restoreDepth=function(t){-1!==t&&t!==this.depth&&(this.maskOffset-=this.maskSize),this.depth=t}},{"./tree":9}],9:[function(t,e,n){function i(t,e){this.predicates=t,this.body=e}function r(){}function s(t,e){this.conditions=[],this.children=[];for(var n=e.length-1;n>=0;n--){var i=e[n];i instanceof r?this.conditions.push(i):i===t.boundBody?this.children[n]=t.queue.pop():this.children[n]=i}}function o(t){r.call(this),this.refs=t}function h(t){r.call(this),this.refs=t}function c(t){r.call(this),this.refs=t}function a(t,e){r.call(this),this.mode=t,this.refs=e}function u(t){r.call(this),this.options=t}function l(t,e){r.call(this),this.key=t,this.value=e}function p(t){r.call(this),this.body=t}function f(t){this.options=t,this.refs=this.options.refs,this.boundBody=this.body.bind(this);for(var e=this.methods("body"),n=0;n<e.length;n++){var i=e[n];this.boundBody[f.methods[n]]=i}this.queue=[],this.templates=[],this.initializers=[]}function d(t,e,n){var i=t[n],r=t.boundBody;return"body"!==e?"replace"===n||"extend"===n||"wrap"===n?function(){return i.apply(t,arguments)}:function(){return i.apply(t,arguments),r}:function(){var e=i.apply(t,arguments),s=t.queue.pop(),o=t.queue[t.queue.length-1];return o.conditions=o.conditions.concat(s.conditions),o.children=o.children.concat(s.children),"replace"===n||"extend"===n||"wrap"===n?e:r}}function m(t){return t[0].toUpperCase()+t.slice(1)}var y=t("inherits"),x=t("./utils");n.Template=i,i.prototype.wrap=function(){for(var t=this.body,e=0;e<this.predicates.length;e++){t=this.predicates[e].wrapBody(t)}this.body=t},i.prototype.clone=function(){return new i(this.predicates.slice(),this.body)},n.MatchBase=r,r.prototype.wrapBody=function(t){return t},y(o,r),n.WrapMatch=o,o.prototype.wrapBody=function(t){var e=this.refs._applyCtx;return"function"!=typeof t?function(){return e(t)}:function(){return e(t.call(this,this,this.ctx))}},y(h,r),n.ReplaceMatch=h,h.prototype.wrapBody=function(t){var e=this.refs.applyCtx;return"function"!=typeof t?function(){return e(t,{position:this.position-1})}:function(){return e(t.call(this,this,this.ctx),{position:this.position-1})}},y(c,r),n.ExtendMatch=c,c.prototype.wrapBody=function(t){var e=this.refs,n=e.applyCtx;return"function"!=typeof t?function(){for(var e={},i=Object.keys(t),r=0;r<i.length;r++)e[i[r]]=t[i[r]];return n(this.ctx,e)}:function(){for(var e={},i=t.call(this,this,this.ctx),r=Object.keys(i),s=0;s<r.length;s++)e[r[s]]=i[r[s]];return n(this.ctx,e)}},y(a,r),n.AddMatch=a,a.prototype.wrapBody=function(t){return this[this.mode+"WrapBody"](t)},a.prototype.appendContentWrapBody=function(t){var e=this.refs.apply;return"function"!=typeof t?function(){return[e("content"),t]}:function(){return[e("content"),t.call(this,this,this.ctx)]}},a.prototype.prependContentWrapBody=function(t){var e=this.refs.apply;return"function"!=typeof t?function(){return[t,e("content")]}:function(){return[t.call(this,this,this.ctx),e("content")]}},a.prototype.mixWrapBody=function(t){var e=this.refs.apply;return"function"!=typeof t?function(){var n=e("mix");return Array.isArray(n)||(n=[n]),n.concat(t)}:function(){var n=e("mix");return Array.isArray(n)||(n=[n]),n.concat(t.call(this,this,this.ctx))}},["attrs","js","mods","elemMods"].forEach(function(t){a.prototype[t+"WrapBody"]=function(e){var n=this.refs.apply;return"function"!=typeof e?function(){return this[t]=x.extend(n(t)||{},e)}:function(){return this[t]=x.extend(n(t)||{},e.call(this,this,this.ctx))}}}),y(u,r),n.CompilerOptions=u,y(l,r),n.PropertyMatch=l,y(p,r),n.CustomMatch=p,n.Tree=f,f.methods=["match","block","elem","mod","elemMod","oninit","xjstOptions","wrap","replace","extend","mode","def","content","appendContent","prependContent","attrs","addAttrs","js","addJs","mix","addMix","mods","addMods","addElemMods","elemMods","tag","cls","bem"],f.prototype.build=function(t,e){var n=this.methods("global").concat(e);return n[0]=this.match.bind(this),t.apply({},n),{templates:this.templates.slice().reverse(),oninit:this.initializers}},f.prototype.methods=function(t){for(var e=new Array(f.methods.length),n=0;n<e.length;n++){var i=f.methods[n];e[n]=d(this,t,i)}return e},f.prototype.flush=function(t,e){for(var n=e.conditions?t.concat(e.conditions):e.conditions,i=0;i<e.children.length;i++){var r=e.children[i];if(r instanceof s)this.flush(n,e.children[i]);else if(this.isShortcutAllowed(r,t))for(var o=Object.keys(r),h=0;h<o.length;h++)this.addTemplate(t.concat(this.createMatch(o[h])),r[o[h]]);else this.addTemplate(t,r)}},f.prototype.createMatch=function(t){switch(t){case"addAttrs":return[new l("_mode","attrs"),new a("attrs",this.refs)];case"addJs":return[new l("_mode","js"),new a("js",this.refs)];case"addMix":return[new l("_mode","mix"),new a("mix",this.refs)];case"addMods":return[new l("_mode","mods"),new a("mods",this.refs)];case"addElemMods":return[new l("_mode","elemMods"),new a("elemMods",this.refs)];case"appendContent":case"prependContent":return[new l("_mode","content"),new a(t,this.refs)];case"wrap":return new o(this.refs);case"replace":return new h(this.refs);case"extend":return new c(this.refs);case"def":return new l("_mode","default");default:return new l("_mode",t)}},f.prototype.addTemplate=function(t,e){var n=new i(t,e);n.wrap(),this.templates.push(n)},f.prototype.body=function(){for(var t=new Array(arguments.length),e=0;e<arguments.length;e++)t[e]=arguments[e];var n=new s(this,t);return this.queue[this.queue.length-1].children.push(n),1===this.queue.length&&this.flush([],this.queue.shift()),this.boundBody},f.modsCheck={mods:1,elemMods:1},f.checkConditions=function(t){for(var e=0;e<t.length;e++){var n=t[e];if(!("block"===n.key||"elem"===n.key||Array.isArray(n.key)&&f.modsCheck[n.key[0]]||n instanceof p))return!1}return!0},f.prototype.isShortcutAllowed=function(t,e){return"object"==typeof t&&null!==t&&!Array.isArray(t)&&f.checkConditions(e)},f.prototype.match=function(){var t=new Array(arguments.length);if(!arguments.length)throw new Error(".match() must have argument");for(var e=0;e<arguments.length;e++){var n=arguments[e];if("function"==typeof n&&(n=new p(n)),!(n instanceof r))throw new Error("Wrong .match() argument");t[e]=n}return this.queue.push(new s(this,t)),this.boundBody},f.prototype.applyMode=function(t,e){if(t.length)throw new Error("Predicate should not have arguments but "+JSON.stringify(t)+" passed");return this.mode(e)},f.prototype.xjstOptions=function(t){return this.queue.push(new s(this,[new u(t)])),this.boundBody},["mode","elem","block"].forEach(function(t){f.prototype[t]=function(e){return this.match(new l("mode"===t?"_mode":t,e))}}),["mod","elemMod"].forEach(function(t){f.prototype[t]=function(e,n){return this.match(new l([t+"s",e],void 0===n||String(n)))}}),f.prototype.def=function(){return this.applyMode(arguments,"default")},["content","mix","bem","js","cls","attrs","tag","elemMods","mods"].forEach(function(t){f.prototype[t]=function(){return this.applyMode(arguments,t)}}),["appendContent","prependContent"].forEach(function(t){f.prototype[t]=function(){return this.content.apply(this,arguments).match(new a(t,this.refs))}}),["mods","elemMods","attrs","js","mix"].forEach(function(t){f.prototype["add"+m(t)]=function(){return this[t].apply(this,arguments).match(new a(t,this.refs))}}),f.prototype.wrap=function(){return this.def.apply(this,arguments).match(new o(this.refs))},f.prototype.replace=function(){return this.def.apply(this,arguments).match(new h(this.refs))},f.prototype.extend=function(){return this.def.apply(this,arguments).match(new c(this.refs))},f.prototype.oninit=function(t){this.initializers.push(t)}},{"./utils":10,inherits:11}],10:[function(t,e,n){function i(t){return void 0===t||null===t||"number"==typeof t&&isNaN(t)}function r(){return p+ ++a}var s=/[&<>]/;n.xmlEscape=function(t){if(i(t))return"";var e=""+t,n=s.exec(e);if(!n)return e;var r,o="",h=0,c=0;for(h=n.index;h<e.length;h++){switch(e.charCodeAt(h)){case 38:r="&amp;";break;case 60:r="&lt;";break;case 62:r="&gt;";break;default:continue}c!==h&&(o+=e.substring(c,h)),c=h+1,o+=r}return c!==h?o+e.substring(c,h):o};var o=/["&]/;n.attrEscape=function(t){if(i(t))return"";var e=""+t,n=o.exec(e);if(!n)return e;var r,s="",h=0,c=0;for(h=n.index;h<e.length;h++){switch(e.charCodeAt(h)){case 34:r="&quot;";break;case 38:r="&amp;";break;default:continue}c!==h&&(s+=e.substring(c,h)),c=h+1,s+=r}return c!==h?s+e.substring(c,h):s};var h=/['&]/;n.jsAttrEscape=function(t){if(i(t))return"";var e=""+t,n=h.exec(e);if(!n)return e;var r,s="",o=0,c=0;for(o=n.index;o<e.length;o++){switch(e.charCodeAt(o)){case 38:r="&amp;";break;case 39:r="&#39;";break;default:continue}c!==o&&(s+=e.substring(c,o)),c=o+1,s+=r}return c!==o?s+e.substring(c,o):s},n.extend=function(t,e){if(!t||!e)return t||e;var n,i={};for(n in t)t.hasOwnProperty(n)&&(i[n]=t[n]);for(n in e)e.hasOwnProperty(n)&&(i[n]=e[n]);return i};var c={area:1,base:1,br:1,col:1,command:1,embed:1,hr:1,img:1,input:1,keygen:1,link:1,meta:1,param:1,source:1,wbr:1};n.isShortTag=function(t){return c.hasOwnProperty(t)},n.isSimple=function t(e){return!e||!0===e||(!(e.block||e.elem||e.tag||e.cls||e.attrs||!e.hasOwnProperty("html")||!t(e.html))||("string"==typeof e||"number"==typeof e))},n.isObj=function(t){return t&&"object"==typeof t&&!Array.isArray(t)&&null!==t};var a=0,u=+new Date,l="__"+u,p="uniq"+u;n.getUniq=r,n.identify=function(t,e){if(!t)return r();if(e||t[l])return t[l];var n=r();return t[l]=n,n},n.fnToString=function(t){return t?("function"==typeof t&&(t=t.toString(),t=t.replace(0===t.indexOf("function")?/^function\s*[^{]+{|}$/g:/^(_|\(\w|[^=>]+\))\s=>\s{|}$/g,"")),t):""};var f=/^[:\w.-]+$/;n.isUnquotedAttr=function(t){return t&&f.exec(t)}},{}],11:[function(t,e,n){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}]},{},[2])(2)}),e.exports||n.BEMHTML}({},{}),r=new i({exportName:"BEMHTML",to:"/Users/miripiruni/Documents/www/bem-xjst-online"});return r.compile(function(t,e,n,i,r,s,o,h,c,a,u,l,p,f,d,m,y,x,v,b,w,g,k,E,M,_,B,j,C,O,A,T){s(function(t,e){(t.BEMContext||e.BEMContext).prototype.require=function(t){return this._libs[t]}})}),n=r.exportApply(n),e&&(n.BEMContext.prototype._libs=e),n}var n=this.window||this.global||this,i="undefined"!=typeof exports?exports:t,r={};Object.keys(r).length?(BEMHTML=e,i.BEMHTML=BEMHTML,i.BEMHTML.libs=r):(BEMHTML=e,i.BEMHTML=BEMHTML,i.BEMHTML.libs=n)}("undefined"!=typeof window?window:"undefined"!=typeof global?global:this);var BEMTREE;!function(t){function e(e){var n,i=function(e,n){return function(i){if("object"==typeof n&&void 0!==e)e.exports=i();else if("function"==typeof define&&define.amd)define([],i);else{var r;r="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:this,r.bemtree=i()}}(function(){return function t(e,n,i){function r(o,h){if(!n[o]){if(!e[o]){var c="function"==typeof require&&require;if(!h&&c)return c(o,!0);if(s)return s(o,!0);var a=new Error("Cannot find module '"+o+"'");throw a.code="MODULE_NOT_FOUND",a}var u=n[o]={exports:{}};e[o][0].call(u.exports,function(t){var n=e[o][1][t];return r(n||t)},u,u.exports,t,e,n,i)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(t,e,n){function i(){s.apply(this,arguments)}var r=t("inherits"),s=t("../bemxjst/entity").Entity;r(i,s),n.Entity=i,i.prototype.defaultBody=function(t){return t.mods=this.mods.exec(t),t.ctx.elem&&(t.elemMods=this.elemMods.exec(t)),this.bemxjst.render(t,this,this.content.exec(t),this.js.exec(t),this.mix.exec(t),t.mods,t.elemMods)}},{"../bemxjst/entity":5,inherits:11}],2:[function(t,e,n){function i(){s.apply(this,arguments)}var r=t("inherits"),s=t("../bemxjst"),o=t("./entity").Entity,h=t("../bemxjst/utils");r(i,s),e.exports=i,i.prototype.Entity=o,i.prototype.runMany=function(t){var e=[],n=this.context,i=n.position,r=n._notNewList;if(r?n._listLength+=t.length-1:(n.position=0,n._listLength=t.length),n._notNewList=!0,this.canFlush)for(var s=0;s<t.length;s++)e+=n._flush(this._run(t[s]));else for(var s=0;s<t.length;s++)e.push(this._run(t[s]));return r||(n.position=i),e},i.prototype.render=function(t,e,n,i,r,s,o){var c=h.extend({},t.ctx),a=!!(c.block||c.elem||c.bem);return void 0!==i&&(c.js=i),void 0!==r&&(c.mix=r),!e.elem&&s&&Object.keys(s).length>0&&(c.mods=h.extend(c.mods||{},s)),e.elem&&o&&Object.keys(o).length>0&&(c.elemMods=h.extend(c.elemMods||{},o)),void 0===n?c:(c.content=this.renderContent(n,a),c)},i.prototype._run=function(t){return t&&!0!==t?s.prototype._run.call(this,t):t},i.prototype.runUnescaped=function(t){return this.context._listLength--,t}},{"../bemxjst":7,"../bemxjst/utils":10,"./entity":1,inherits:11}],3:[function(t,e,n){function i(t){this.elemDelim=t.elem||"__",this.modDelim="string"==typeof t.mod?{name:t.mod||"_",val:t.mod||"_"}:{name:t.mod&&t.mod.name||"_",
val:t.mod&&t.mod.val||"_"}}n.ClassBuilder=i,i.prototype.build=function(t,e){return e?t+this.elemDelim+e:t},i.prototype.buildModPostfix=function(t,e){var n=this.modDelim.name+t;return!0!==e&&(n+=this.modDelim.val+e),n},i.prototype.buildBlockClass=function(t,e,n){var i=t;return n&&(i+=this.buildModPostfix(e,n)),i},i.prototype.buildElemClass=function(t,e,n,i){return this.buildBlockClass(t)+this.elemDelim+e+this.buildModPostfix(n,i)},i.prototype.split=function(t){return t.split(this.elemDelim,2)}},{}],4:[function(t,e,n){function i(t){this._bemxjst=t,this.ctx=null,this.block="",this._currBlock="",this.elem=null,this.mods={},this.elemMods={},this.position=0,this._listLength=0,this._notNewList=!1,this.escapeContent=!1!==t.options.escapeContent}var r=t("./utils");n.Context=i,i.prototype._flush=null,i.prototype.isSimple=r.isSimple,i.prototype.isShortTag=r.isShortTag,i.prototype.extend=r.extend,i.prototype.identify=r.identify,i.prototype.xmlEscape=r.xmlEscape,i.prototype.attrEscape=r.attrEscape,i.prototype.jsAttrEscape=r.jsAttrEscape,i.prototype.onError=function(t,e){console.error("bem-xjst rendering error:",{block:t.ctx.block,elem:t.ctx.elem,mods:t.ctx.mods,elemMods:t.ctx.elemMods},e)},i.prototype.isFirst=function(){return 1===this.position},i.prototype.isLast=function(){return this.position===this._listLength},i.prototype.generateId=function(){return r.identify(this.ctx)},i.prototype.reapply=function(t){return this._bemxjst.run(t)}},{"./utils":10}],5:[function(t,e,n){function i(t,e,n,i){this.bemxjst=t,this.block=null,this.elem=null,this.options={},this.canFlush=!0,this.def=new o(this),this.mix=new o(this,"mix"),this.js=new o(this,"js"),this.mods=new o(this,"mods"),this.elemMods=new o(this,"elemMods"),this.content=new o(this,"content"),this.rest={},this.init(e,n),this.initModes(i)}function r(){return this.ctx.content}var s=t("./utils"),o=t("./match").Match,h=t("./tree"),c=h.Template,a=h.PropertyMatch,u=h.CompilerOptions;n.Entity=i,i.prototype.init=function(t,e){this.block=t,this.elem=e},i.prototype._keys={content:1,mix:1,js:1,mods:1,elemMods:1},i.prototype._initRest=function(t){"default"===t?this.rest[t]=this.def:this._keys[t]?this.rest[t]=this[t]:this.rest[t]=this.rest[t]||new o(this,t)},i.prototype.initModes=function(t){for(var e=0;e<t.length;e++){for(var n=t[e],i=n.predicates.length-1;i>=0;i--){var r=n.predicates[i];if(r instanceof a&&"_mode"===r.key){n.predicates.splice(i,1),this._initRest(r.value),this.rest[r.value].push(n);break}}-1===i&&this.def.push(n);for(var i=n.predicates.length-1;i>=0;i--){var r=n.predicates[i];r instanceof u&&(this.options=s.extend(this.options,r.options))}}},i.prototype.prepend=function(t){for(var e=Object.keys(this.rest),n=0;n<e.length;n++){var i=e[n];t.rest[i]&&this.rest[i].prepend(t.rest[i])}e=Object.keys(t.rest);for(var n=0;n<e.length;n++){var i=e[n];this.rest[i]||(this._initRest(i),this.rest[i].prepend(t.rest[i]))}},i.prototype.run=function(t){return 0!==this.def.count?this.def.exec(t):this.defaultBody(t)},i.prototype.setDefaults=function(){if(0!==this.content.count&&this.content.push(new c([],r)),0!==this.def.count){this.canFlush=this.options.flush||!1;var t=this;this.def.push(new c([],function(){return t.defaultBody(this)}))}}},{"./match":8,"./tree":9,"./utils":10}],6:[function(t,e,n){function i(t,e){this.name="BEMXJSTError",this.message=t,Error.captureStackTrace?Error.captureStackTrace(this,e||this.constructor):this.stack=(new Error).stack}i.prototype=Object.create(Error.prototype),i.prototype.constructor=i,n.BEMXJSTError=i},{}],7:[function(t,e,n){function i(t){this.options=t,this.entities=null,this.defaultEnt=null,this.tree=null,this.match=null,this.contextConstructor=function(t){c.call(this,t)},r(this.contextConstructor,c),this.context=null,this.classBuilder=new a(this.options.naming||{}),this.depth=0,this.canFlush=!1,this.oninit=null,this.defaultEnt=new this.Entity(this,"","",[]),this.defaultElemEnt=new this.Entity(this,"","",[])}var r=t("inherits"),s=t("./tree").Tree,o=t("./tree").PropertyMatch,h=t("./tree").AddMatch,c=t("./context").Context,a=t("./class-builder").ClassBuilder,u=t("./utils");e.exports=i,i.prototype.locals=s.methods.concat("local","applyCtx","applyNext","apply"),i.prototype.runOninit=function(t,e){var n=e||this;n.BEMContext=this.contextConstructor;for(var i=0;i<t.length;i++){(0,t[i])(n,{BEMContext:n.BEMContext})}},i.prototype.compile=function(t){function e(){return c.run(c.context.ctx)}function n(){return c._run(c.context.ctx)}function i(t,i){return i?c.local(i,function(){return c.local({ctx:t},n)}):c.local({ctx:t},e)}function r(t,i){return i?c.local(i,function(){return c.local({ctx:t},e)}):c.local({ctx:t},n)}function o(t,e){return c.applyMode(t,e)}function h(t){return function(e){return c.local(t,e)}}var c=this,a=new s({refs:{applyCtx:i,_applyCtx:r,apply:o}}),u=this.recompileInput(t),l=a.build(u,[h,i,function t(e){return e?c.local(e,t):c.applyNext()},o]);this.tree&&(this.runOninit(l.oninit),l={templates:l.templates.concat(this.tree.templates),oninit:this.tree.oninit.concat(l.oninit)}),this.tree=l;var p=this.groupEntities(l.templates);p=this.transformEntities(p),this.entities=p,this.oninit=l.oninit},i.prototype.getTemplate=function(t,e){return this.compile(t,e),this.exportApply()},i.prototype.recompileInput=function(t){var e=i.prototype.locals;return"function"==typeof t&&t.length===e.length?t:new Function(e.join(", "),u.fnToString(t))},i.prototype.groupEntities=function(e){for(var n={},i=0;i<e.length;i++){var r,s=e[i].clone(),c=null;r=void 0;for(var a=0;a<s.predicates.length;a++){var u=s.predicates[a];if(u instanceof o||u instanceof h){if("block"===u.key)c=u.value;else{if("elem"!==u.key)continue;r=u.value}s.predicates.splice(a,1),a--}}if(null===c){for(var l="block(…) subpredicate is not found.\n    See template with subpredicates:\n     * ",a=0;a<s.predicates.length;a++){var u=s.predicates[a];0!==a&&(l+="\n     * "),"_mode"===u.key?l+=u.value+"()":Array.isArray(u.key)?l+=u.key[0].replace("mods","mod").replace("elemMods","elemMod")+"('"+u.key[1]+"', '"+u.value+"')":l+="match(…)"}throw l+="\n    And template body: \n    ("+("function"==typeof s.body?s.body:JSON.stringify(s.body))+")","undefined"==typeof BEMXJSTError&&(BEMXJSTError=t("./error").BEMXJSTError),new BEMXJSTError(l)}var p=this.classBuilder.build(c,r);n[p]||(n[p]=[]),n[p].push(s)}return n},i.prototype.transformEntities=function(t){for(var e=[],n=Object.keys(t),i=0;i<n.length;i++){var r=n[i],s=this.classBuilder.split(r),o=s[0],h=s[1];"*"===h&&e.push(o),t[r]=new this.Entity(this,o,h,t[r])}if(t.hasOwnProperty("*")){for(var c=t["*"],i=0;i<n.length;i++){var r=n[i];"*"!==r&&t[r].prepend(c)}this.defaultEnt.prepend(c),this.defaultElemEnt.prepend(c)}for(var i=0;i<e.length;i++){for(var o=e[i],a=this.classBuilder.build(o,"*"),c=t[a],i=0;i<n.length;i++){var r=n[i];if(r!==a){var u=t[r];u.block===o&&void 0!==u.elem&&t[r].prepend(c)}}this.defaultElemEnt.prepend(c)}for(var i=0;i<n.length;i++){var r=n[i];t[r].setDefaults(),this.defaultEnt.setDefaults(),this.defaultElemEnt.setDefaults()}return t},i.prototype._run=function(t){return void 0===t||""===t||null===t?this.runEmpty():Array.isArray(t)?this.runMany(t):"string"!=typeof t.html||t.tag||void 0!==t.block||void 0!==t.elem||void 0!==t.cls||void 0!==t.attrs?u.isSimple(t)?this.runSimple(t):this.runOne(t):this.runUnescaped(t)},i.prototype.run=function(t){var e=this.match,n=this.context,i=this.depth;this.match=null,this.context=new this.contextConstructor(this),this.canFlush=null!==this.context._flush,this.depth=0;var r=this._run(t);return this.canFlush&&(r=this.context._flush(r)),this.match=e,this.context=n,this.depth=i,r},i.prototype.runEmpty=function(){return this.context._listLength--,""},i.prototype.runUnescaped=function(t){return this.context._listLength--,""+t.html},i.prototype.runSimple=function(t){return this.context._listLength--,!t&&0!==t||!0===t?"":"string"==typeof t&&this.context.escapeContent?u.xmlEscape(t):t},i.prototype.runOne=function(t){var e=this.context,n=e.ctx,i=e.block,r=e._currBlock,s=e.elem,o=e.mods,h=e.elemMods;t.block||t.elem?e._currBlock="":e._currBlock=e.block,e.ctx=t,t.block?(e.block=t.block,t.mods?e.mods=t.mods:t.block===i&&t.elem||(e.mods={})):t.elem?r&&(e.block=r):e.block="",e.elem=t.elem,t.elemMods?e.elemMods=t.elemMods:e.elemMods={};var c=e.block||"",a=e.elem;c||a?e.position++:e._listLength--,this.depth++;var u=!1,l=this.entities[this.classBuilder.build(c,a)];l?this.canFlush&&!l.canFlush&&(u=!0,this.canFlush=!1):(l=this.defaultEnt,void 0!==a&&(l=this.defaultElemEnt),l.init(c,a));var p=!0===this.options.production?this.tryRun(e,l):l.run(e);return e.ctx=n,e.block=i,e.elem=s,e.mods=o,e.elemMods=h,e._currBlock=r,this.depth--,u&&(this.canFlush=!0),p},i.prototype.tryRun=function(t,e){try{return e.run(t)}catch(e){return t.onError(t,e)||""}},i.prototype.renderContent=function(t,e){var n=this.context,i=n.position,r=n._listLength,s=n._notNewList;n._notNewList=!1,e&&(n.position=0,n._listLength=1);var o=this._run(t);return n.position=i,n._listLength=r,n._notNewList=s,o},i.prototype.local=function(t,e){for(var n=Object.keys(t),i=[],r=0;r<n.length;r++){for(var s=n[r],o=s.split("."),h=this.context,c=0;c<o.length-1;c++)h=h[o[c]];i.push({parts:o,value:h[o[c]]}),h[o[c]]=t[s]}for(var a=e.call(this.context),r=0;r<i.length;r++){for(var o=i[r].parts,h=this.context,c=0;c<o.length-1;c++)h=h[o[c]];h[o[c]]=i[r].value}return a},i.prototype.applyNext=function(){return this.match.exec(this.context)},i.prototype.applyMode=function(t,e){var n,i=this.match;if(i)i=this.match.entity.rest[t];else{var n=this.classBuilder.build(this.context.block,this.context.elem);i=this.entities[n].rest[t]}if(!i)return"mods"===t?this.context.mods:"elemMods"===t?this.context.elemMods:this.context.ctx[t];if(!e)return i.exec(this.context);var r=this,s=function(){return i.exec(r.context)};return this.local(e,s)},i.prototype.exportApply=function(t){var e=this,n=t||{};return n.apply=function(t){return e.run(t)},n.compile=function(t){return e.compile(t),n},this.runOninit(e.oninit,n),n}},{"./class-builder":3,"./context":4,"./error":6,"./tree":9,"./utils":10,inherits:11}],8:[function(t,e,n){function i(t,e){this.template=t,this.keys=e.key,this.value=e.value}function r(t,e){this.template=t,this.body=e.body}function s(t){this.template=t,this.wrap=null}function o(t){this.template=t,this.wrap=null}function h(t,e){this.template=t,this.key=e.key,this.value=e.value}function c(t,e){this.mode=t,this.predicates=new Array(e.predicates.length),this.body=e.body;for(var n=[],c=0,a=0;c<this.predicates.length;c++,a++){var u=e.predicates[c];u instanceof l?this.predicates[a]=new i(this,u):u instanceof d?(a--,n.push(new o(this))):u instanceof p?this.predicates[a]=new h(this,u):u instanceof m?this.predicates[a]=new r(this,u):u instanceof f?(a--,n.push(new s(this))):a--}for(var c=0;c<n.length;c++,a++)this.predicates[a]=n[c];this.predicates.length!==a&&(this.predicates.length=a)}function a(t,e){this.entity=t,this.modeName=e,this.bemxjst=this.entity.bemxjst,this.templates=[],this.mask=[0],this.maskSize=0,this.maskOffset=0,this.count=0,this.depth=-1,this.thrownError=null}var u=t("./tree"),l=u.PropertyMatch,p=u.AddMatch,f=u.WrapMatch,d=u.ExtendMatch,m=u.CustomMatch;i.prototype.exec=function(t){for(var e=t,n=0;n<this.keys.length-1;n++)if(!(e=e[this.keys[n]]))return!1;return e=e[this.keys[n]],!0===this.value?void 0!==e&&""!==e&&!1!==e&&null!==e:String(e)===this.value},r.prototype.exec=function(t){return this.body.call(t,t,t.ctx)},s.prototype.exec=function(t){var e=this.wrap!==t.ctx;return this.wrap=t.ctx,e},o.prototype.exec=function(t){var e=this.ext!==t.ctx;return this.ext=t.ctx,e},h.prototype.exec=function(t){return t[this.key]===this.value},n.MatchTemplate=c,n.Match=a,a.prototype.prepend=function(t){for(this.templates=t.templates.concat(this.templates),this.count+=t.count;Math.ceil(this.count/31)>this.mask.length;)this.mask.push(0);this.maskSize=this.mask.length},a.prototype.push=function(t){this.templates.push(new c(this,t)),this.count++,Math.ceil(this.count/31)>this.mask.length&&this.mask.push(0),this.maskSize=this.mask.length},a.prototype.tryCatch=function(t,e){try{return t.call(e,e,e.ctx)}catch(t){if(this.thrownError=t,this.modeName){this.thrownError.ctx=e,this.thrownError.name="BEMXJST ERROR";var n=this.entity.bemxjst.classBuilder,i=t.stack.split("\n")[1];this.thrownError.message="Template error in mode "+this.modeName+" in block "+n.build(e.ctx.block,e.ctx.elem)+"\n    "+t.message+"\n",this.thrownError.stack=this.thrownError.name+": "+this.thrownError.message+" "+i+"\n"+t.stack}}},a.prototype.exec=function(t){for(var e,n=this.checkDepth(),i=this.maskOffset,r=this.mask[i],s=1,o=0;o<this.count;o++){if(0==(r&s)){e=this.templates[o];for(var h=0;h<e.predicates.length;h++){if(!e.predicates[h].exec(t))break}if(h===e.predicates.length)break}1073741824===s?(i++,r=this.mask[i],s=1):s<<=1}if(o===this.count)return this.restoreDepth(n),"mods"===this.modeName?t.mods:"elemMods"===this.modeName?t.elemMods:t.ctx[this.modeName];var c=r,a=this.bemxjst.match;this.mask[i]|=s,this.bemxjst.match=this,this.thrownError=null;var u;u="function"==typeof e.body?this.tryCatch(e.body,t):e.body,this.mask[i]=c,this.bemxjst.match=a,this.restoreDepth(n);var l=this.thrownError;if(null!==l)throw this.thrownError=null,l;return u},a.prototype.checkDepth=function(){if(-1===this.depth)return this.depth=this.bemxjst.depth,-1;if(this.bemxjst.depth===this.depth)return this.depth;var t=this.depth;for(this.depth=this.bemxjst.depth,this.maskOffset+=this.maskSize;this.mask.length<this.maskOffset+this.maskSize;)this.mask.push(0);return t},a.prototype.restoreDepth=function(t){-1!==t&&t!==this.depth&&(this.maskOffset-=this.maskSize),this.depth=t}},{"./tree":9}],9:[function(t,e,n){function i(t,e){this.predicates=t,this.body=e}function r(){}function s(t,e){this.conditions=[],this.children=[];for(var n=e.length-1;n>=0;n--){var i=e[n];i instanceof r?this.conditions.push(i):i===t.boundBody?this.children[n]=t.queue.pop():this.children[n]=i}}function o(t){r.call(this),this.refs=t}function h(t){r.call(this),this.refs=t}function c(t){r.call(this),this.refs=t}function a(t,e){r.call(this),this.mode=t,this.refs=e}function u(t){r.call(this),this.options=t}function l(t,e){r.call(this),this.key=t,this.value=e}function p(t){r.call(this),this.body=t}function f(t){this.options=t,this.refs=this.options.refs,this.boundBody=this.body.bind(this);for(var e=this.methods("body"),n=0;n<e.length;n++){var i=e[n];this.boundBody[f.methods[n]]=i}this.queue=[],this.templates=[],this.initializers=[]}function d(t,e,n){var i=t[n],r=t.boundBody;return"body"!==e?"replace"===n||"extend"===n||"wrap"===n?function(){return i.apply(t,arguments)}:function(){return i.apply(t,arguments),r}:function(){var e=i.apply(t,arguments),s=t.queue.pop(),o=t.queue[t.queue.length-1];return o.conditions=o.conditions.concat(s.conditions),o.children=o.children.concat(s.children),"replace"===n||"extend"===n||"wrap"===n?e:r}}function m(t){return t[0].toUpperCase()+t.slice(1)}var y=t("inherits"),x=t("./utils");n.Template=i,i.prototype.wrap=function(){for(var t=this.body,e=0;e<this.predicates.length;e++){t=this.predicates[e].wrapBody(t)}this.body=t},i.prototype.clone=function(){return new i(this.predicates.slice(),this.body)},n.MatchBase=r,r.prototype.wrapBody=function(t){return t},y(o,r),n.WrapMatch=o,o.prototype.wrapBody=function(t){var e=this.refs._applyCtx;return"function"!=typeof t?function(){return e(t)}:function(){return e(t.call(this,this,this.ctx))}},y(h,r),n.ReplaceMatch=h,h.prototype.wrapBody=function(t){var e=this.refs.applyCtx;return"function"!=typeof t?function(){return e(t,{position:this.position-1})}:function(){return e(t.call(this,this,this.ctx),{position:this.position-1})}},y(c,r),n.ExtendMatch=c,c.prototype.wrapBody=function(t){var e=this.refs,n=e.applyCtx;return"function"!=typeof t?function(){for(var e={},i=Object.keys(t),r=0;r<i.length;r++)e[i[r]]=t[i[r]];return n(this.ctx,e)}:function(){for(var e={},i=t.call(this,this,this.ctx),r=Object.keys(i),s=0;s<r.length;s++)e[r[s]]=i[r[s]];return n(this.ctx,e)}},y(a,r),n.AddMatch=a,a.prototype.wrapBody=function(t){return this[this.mode+"WrapBody"](t)},a.prototype.appendContentWrapBody=function(t){var e=this.refs.apply;return"function"!=typeof t?function(){return[e("content"),t]}:function(){return[e("content"),t.call(this,this,this.ctx)]}},a.prototype.prependContentWrapBody=function(t){var e=this.refs.apply;return"function"!=typeof t?function(){return[t,e("content")]}:function(){return[t.call(this,this,this.ctx),e("content")]}},a.prototype.mixWrapBody=function(t){var e=this.refs.apply;return"function"!=typeof t?function(){var n=e("mix");return Array.isArray(n)||(n=[n]),n.concat(t)}:function(){var n=e("mix");return Array.isArray(n)||(n=[n]),n.concat(t.call(this,this,this.ctx))}},["attrs","js","mods","elemMods"].forEach(function(t){a.prototype[t+"WrapBody"]=function(e){var n=this.refs.apply;return"function"!=typeof e?function(){return this[t]=x.extend(n(t)||{},e)}:function(){return this[t]=x.extend(n(t)||{},e.call(this,this,this.ctx))}}}),y(u,r),n.CompilerOptions=u,y(l,r),n.PropertyMatch=l,y(p,r),n.CustomMatch=p,n.Tree=f,f.methods=["match","block","elem","mod","elemMod","oninit","xjstOptions","wrap","replace","extend","mode","def","content","appendContent","prependContent","attrs","addAttrs","js","addJs","mix","addMix","mods","addMods","addElemMods","elemMods","tag","cls","bem"],f.prototype.build=function(t,e){var n=this.methods("global").concat(e);return n[0]=this.match.bind(this),t.apply({},n),{templates:this.templates.slice().reverse(),oninit:this.initializers}},f.prototype.methods=function(t){for(var e=new Array(f.methods.length),n=0;n<e.length;n++){var i=f.methods[n];e[n]=d(this,t,i)}return e},f.prototype.flush=function(t,e){for(var n=e.conditions?t.concat(e.conditions):e.conditions,i=0;i<e.children.length;i++){var r=e.children[i];if(r instanceof s)this.flush(n,e.children[i]);else if(this.isShortcutAllowed(r,t))for(var o=Object.keys(r),h=0;h<o.length;h++)this.addTemplate(t.concat(this.createMatch(o[h])),r[o[h]]);else this.addTemplate(t,r)}},f.prototype.createMatch=function(t){switch(t){case"addAttrs":return[new l("_mode","attrs"),new a("attrs",this.refs)];case"addJs":return[new l("_mode","js"),new a("js",this.refs)];case"addMix":return[new l("_mode","mix"),new a("mix",this.refs)];case"addMods":return[new l("_mode","mods"),new a("mods",this.refs)];case"addElemMods":return[new l("_mode","elemMods"),new a("elemMods",this.refs)];case"appendContent":case"prependContent":return[new l("_mode","content"),new a(t,this.refs)];case"wrap":return new o(this.refs);case"replace":return new h(this.refs);case"extend":return new c(this.refs);case"def":return new l("_mode","default");default:return new l("_mode",t)}},f.prototype.addTemplate=function(t,e){var n=new i(t,e);n.wrap(),this.templates.push(n)},f.prototype.body=function(){for(var t=new Array(arguments.length),e=0;e<arguments.length;e++)t[e]=arguments[e];var n=new s(this,t);return this.queue[this.queue.length-1].children.push(n),1===this.queue.length&&this.flush([],this.queue.shift()),this.boundBody},f.modsCheck={mods:1,elemMods:1},f.checkConditions=function(t){for(var e=0;e<t.length;e++){var n=t[e];if(!("block"===n.key||"elem"===n.key||Array.isArray(n.key)&&f.modsCheck[n.key[0]]||n instanceof p))return!1}return!0},f.prototype.isShortcutAllowed=function(t,e){return"object"==typeof t&&null!==t&&!Array.isArray(t)&&f.checkConditions(e)},f.prototype.match=function(){var t=new Array(arguments.length);if(!arguments.length)throw new Error(".match() must have argument");for(var e=0;e<arguments.length;e++){var n=arguments[e];if("function"==typeof n&&(n=new p(n)),!(n instanceof r))throw new Error("Wrong .match() argument");t[e]=n}return this.queue.push(new s(this,t)),this.boundBody},f.prototype.applyMode=function(t,e){if(t.length)throw new Error("Predicate should not have arguments but "+JSON.stringify(t)+" passed");return this.mode(e)},f.prototype.xjstOptions=function(t){return this.queue.push(new s(this,[new u(t)])),this.boundBody},["mode","elem","block"].forEach(function(t){f.prototype[t]=function(e){return this.match(new l("mode"===t?"_mode":t,e))}}),["mod","elemMod"].forEach(function(t){f.prototype[t]=function(e,n){return this.match(new l([t+"s",e],void 0===n||String(n)))}}),f.prototype.def=function(){return this.applyMode(arguments,"default")},["content","mix","bem","js","cls","attrs","tag","elemMods","mods"].forEach(function(t){f.prototype[t]=function(){return this.applyMode(arguments,t)}}),["appendContent","prependContent"].forEach(function(t){f.prototype[t]=function(){return this.content.apply(this,arguments).match(new a(t,this.refs))}}),["mods","elemMods","attrs","js","mix"].forEach(function(t){f.prototype["add"+m(t)]=function(){return this[t].apply(this,arguments).match(new a(t,this.refs))}}),f.prototype.wrap=function(){return this.def.apply(this,arguments).match(new o(this.refs))},f.prototype.replace=function(){return this.def.apply(this,arguments).match(new h(this.refs))},f.prototype.extend=function(){return this.def.apply(this,arguments).match(new c(this.refs))},f.prototype.oninit=function(t){this.initializers.push(t)}},{"./utils":10,inherits:11}],10:[function(t,e,n){function i(t){return void 0===t||null===t||"number"==typeof t&&isNaN(t)}function r(){return p+ ++a}var s=/[&<>]/;n.xmlEscape=function(t){if(i(t))return"";var e=""+t,n=s.exec(e);if(!n)return e;var r,o="",h=0,c=0;for(h=n.index;h<e.length;h++){switch(e.charCodeAt(h)){case 38:r="&amp;";break;case 60:r="&lt;";break;case 62:r="&gt;";break;default:continue}c!==h&&(o+=e.substring(c,h)),c=h+1,o+=r}return c!==h?o+e.substring(c,h):o};var o=/["&]/;n.attrEscape=function(t){if(i(t))return"";var e=""+t,n=o.exec(e);if(!n)return e;var r,s="",h=0,c=0;for(h=n.index;h<e.length;h++){switch(e.charCodeAt(h)){case 34:r="&quot;";break;case 38:r="&amp;";break;default:continue}c!==h&&(s+=e.substring(c,h)),c=h+1,s+=r}return c!==h?s+e.substring(c,h):s};var h=/['&]/;n.jsAttrEscape=function(t){if(i(t))return"";var e=""+t,n=h.exec(e);if(!n)return e;var r,s="",o=0,c=0;for(o=n.index;o<e.length;o++){switch(e.charCodeAt(o)){case 38:r="&amp;";break;case 39:r="&#39;";break;default:continue}c!==o&&(s+=e.substring(c,o)),c=o+1,s+=r}return c!==o?s+e.substring(c,o):s},n.extend=function(t,e){if(!t||!e)return t||e;var n,i={};for(n in t)t.hasOwnProperty(n)&&(i[n]=t[n]);for(n in e)e.hasOwnProperty(n)&&(i[n]=e[n]);return i};var c={area:1,base:1,br:1,col:1,command:1,embed:1,hr:1,img:1,input:1,keygen:1,link:1,meta:1,param:1,source:1,wbr:1};n.isShortTag=function(t){return c.hasOwnProperty(t)},n.isSimple=function t(e){return!e||!0===e||(!(e.block||e.elem||e.tag||e.cls||e.attrs||!e.hasOwnProperty("html")||!t(e.html))||("string"==typeof e||"number"==typeof e))},n.isObj=function(t){return t&&"object"==typeof t&&!Array.isArray(t)&&null!==t};var a=0,u=+new Date,l="__"+u,p="uniq"+u;n.getUniq=r,n.identify=function(t,e){if(!t)return r();if(e||t[l])return t[l];var n=r();return t[l]=n,n},n.fnToString=function(t){return t?("function"==typeof t&&(t=t.toString(),t=t.replace(0===t.indexOf("function")?/^function\s*[^{]+{|}$/g:/^(_|\(\w|[^=>]+\))\s=>\s{|}$/g,"")),t):""};var f=/^[:\w.-]+$/;n.isUnquotedAttr=function(t){return t&&f.exec(t)}},{}],11:[function(t,e,n){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}]},{},[2])(2)}),e.exports||n.BEMTREE}({},{}),r=new i({exportName:"BEMTREE",to:"/Users/miripiruni/Documents/www/bem-xjst-online"});return r.compile(function(t,e,n,i,r,s,o,h,c,a,u,l,p,f,d,m,y,x,v,b,w,g,k,E,M,_,B,j,C,O,A,T){s(function(t,e){(t.BEMContext||e.BEMContext).prototype.require=function(t){return this._libs[t]}})}),n=r.exportApply(n),e&&(n.BEMContext.prototype._libs=e),n}var n=this.window||this.global||this,i="undefined"!=typeof exports?exports:t,r={};Object.keys(r).length?(BEMTREE=e,i.BEMTREE=BEMTREE,i.BEMTREE.libs=r):(BEMTREE=e,i.BEMTREE=BEMTREE,i.BEMTREE.libs=n)}("undefined"!=typeof window?window:"undefined"!=typeof global?global:this);var BEM={I18N:function(t,e){return e}};